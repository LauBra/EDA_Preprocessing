{
  "hash": "756183a5f043bd9f2583ad4e067c1c26",
  "result": {
    "engine": "knitr",
    "markdown": "## (3) Missing Pipelines in R\n\nAs with the correlation matrices before, there are really good packages to help you understand the missingness structure of your data. This is my recommendation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Remember, if you do not have these packages installed, install them first with (install.packages())\n\nlibrary(naniar)\nlibrary(finalfit)\nlibrary(ggplot2)\nlibrary(mice)\n```\n:::\n\n\nHere I will be using the `airquality` dataset (available as default in all R) but everything would be ready for you to introduce your own dataset in a future.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Ozone           Solar.R           Wind             Temp      \n Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00  \n 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00  \n Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  \n Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88  \n 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  \n Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  \n NA's   :37       NA's   :7                                       \n     Month            Day      \n Min.   :5.000   Min.   : 1.0  \n 1st Qu.:6.000   1st Qu.: 8.0  \n Median :7.000   Median :16.0  \n Mean   :6.993   Mean   :15.8  \n 3rd Qu.:8.000   3rd Qu.:23.0  \n Max.   :9.000   Max.   :31.0  \n                               \n```\n\n\n:::\n:::\n\n\nWe can already see with a simple summary, the ammount of missings we have per column. But what is their underlying structure?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nYourDataset <- airquality\n```\n:::\n\n\n### Plot 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nll <- data.frame(is.na(YourDataset))\n```\n:::\n\n\nOpen up this ll object. What are you seeing here? `is.na()` detects all values coded as `NA` and gives a logical output, `TRUE` if truly a missing value and `FALSE` if not\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(ll)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncols <- sapply(ll, is.logical)\nll[, cols] <- lapply(ll[, cols], as.numeric)\n\nMiss1 <- UpSetR::upset(ll,\n                       nsets = 20, number.angles = 10, point.size = 3.5, line.size = 2,\n                       mainbar.y.label = \"Missing Values\", sets.x.label = \"Total Number Missing Values\",\n                       text.scale = c(2.3, 2.3, 2, 2, 2, 1.75), order.by = \"freq\", sets.bar.color = \"red3\"\n)\n\n\nMiss1\n```\n\n::: {.cell-output-display}\n![](MissingPackages_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nHere we can see common patterns! If missing values were to happen at the same time in different variables, we would see it clearly. Lets store this figure into our own directories so we can then use it for our final research output!\n\n\n::: {.cell}\n\n```{.r .cell-code}\npdf(\"MissingVal1.pdf\", 10, 20)\nprint(Miss1)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nquartz_off_screen \n                2 \n```\n\n\n:::\n:::\n\n\n# Plot 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(vis_miss(YourDataset, warn_large_data = FALSE) + \n        theme(axis.text.x =  element_text(angle = 90)))\n```\n\n::: {.cell-output-display}\n![](MissingPackages_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# uncomment to have your pdf created\n#pdf(\"Missing2.pdf\", 20, 10)\n#print(vis_miss(YourDataset, warn_large_data = FALSE) + \n#        theme(axis.text.x =  element_text(angle = 90)))\n#dev.off()\n```\n:::\n\n\nVery clear outline of missingness in the whole dataset. But be careful in big datasets!\n\n# Plot 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_pattern(YourDataset)\n```\n\n::: {.cell-output-display}\n![](MissingPackages_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Wind Temp Month Day Solar.R Ozone   \n111    1    1     1   1       1     1  0\n35     1    1     1   1       1     0  1\n5      1    1     1   1       0     1  1\n2      1    1     1   1       0     0  2\n       0    0     0   0       7    37 44\n```\n\n\n:::\n\n```{.r .cell-code}\n# uncomment to have your pdf created\n\n#pdf(\"PlotMissing3.pdf\", 4,11)\n#\n#print(missing_pattern(YourDataset))\n#\n#dev.off()\n#\n```\n:::\n\n\nFinal, very clear overview of patterns per variable. Spend a moment trying to understand these values. This function works great with big datasets too, although sometimes it gets a bit busy with lots of numbers.\n\n\nOpen up your three newly created pdfs!\n",
    "supporting": [
      "MissingPackages_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}