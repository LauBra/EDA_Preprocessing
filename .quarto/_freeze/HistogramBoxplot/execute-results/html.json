{
  "hash": "77748da4cd871fc172b8f09e31cfeecc",
  "result": {
    "engine": "knitr",
    "markdown": "## Histograms and Boxplots\n\nHistograms show the overall shape and spread of the data distribution and box plots summarise key statistics (median, spread, and potential outliers) and are particularly helpful for comparing distributions across groups.\n\n### Summary Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example data\ndata <- data.frame(age = c(2,  45, 56, 47, 67, 67, 68, 72, 75, 80, 85,86, 89,125))\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  age\n1   2\n2  45\n3  56\n4  47\n5  67\n6  67\n```\n\n\n:::\n:::\n\n\nWhat is the distribution of the age data? What are the mean, median and standard deviation?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMean <- mean(data$age)\nMedian <- median(data$age)\nSd <- sd(data$age)\n```\n:::\n\n\nOther data distribution descriptors include quantiles, which divide data into equal-sized intervals:\n\n*0% (Minimum)* 25% (Q1, First Quartile) *50% (Median, Second Quartile)* 75% (Q3, Third Quartile) \\*100% (Maximum)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nQuantile <- quantile(data$age)\nQuantile\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    0%    25%    50%    75%   100% \n  2.00  58.75  70.00  83.75 125.00 \n```\n\n\n:::\n:::\n\n\nThe IQR (Interquartile Range) measures the spread of the middle 50% of your data.\n\nIf you look at the Quantile results above, you can calculate it from $IQR=Q3−Q1$, where Q3 is the value beyond which 75% of your data lies. What is then Q2? The value beyond which 25% of your data lies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIQR <- IQR(data$age)\nIQR\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 25\n```\n\n\n:::\n:::\n\n\nCan do it in a single go:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data$age) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00   58.75   70.00   68.86   83.75  125.00 \n```\n\n\n:::\n:::\n\n\nAs we saw, lots of different datasets can end up with these summary statistics, so lets plot it to get real insight about what is happening:\n\n## Histogram in R\n\nA histogram is a way to visualise the frequency distribution of a dataset. It groups data into bins and shows how many data points fall into each bin\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = age)) + \n  geom_histogram() \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nYou can modify the binwidth parameter, what is happening here?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = age)) + \n  geom_histogram(binwidth = 30) \n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nNow lets go back t original and add the mean and median\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = age)) + \n  geom_histogram() +\n  geom_vline(xintercept = Mean, color = \"red\", linetype = \"dashed\", size = 1) +\n  geom_vline(xintercept = Median, color = \"blue\", linetype = \"dashed\", size = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIf do not remember how ggplot works , here is a cheatsheet: <https://rstudio.github.io/cheatsheets/html/data-visualization.html>\n\nIn summary, a histogram helps you understand the shape of your data distribution (e.g., normal, skewed) and peaks indicate the most frequent values.\n\n------------------------------------------------------------------------\n\n## Box Plot in R\n\nA box plot (or box-and-whisker plot) summarises the distribution of a dataset. It highlights:\n\n-   Median (middle line in the box).\n-   Quantiles (the box spans from the 25th percentile to the 75th percentile)\n-   IQR (Interquartile Range): The difference between the 75th and 25th percentiles - (IQR range calculated above)\n-   Whiskers: Extend to data points within 1.5\\*IQR (above or beyond = outliers)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = age)) + \n  geom_boxplot() + \n  coord_flip() #have you checked what this does? Take it out and see\n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nCan you see summary statistics mapped here?\n\nLets plot the mean (as it is a value that is not reflected in a boxplot!)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = age)) + \n  geom_boxplot() + \n  coord_flip() + \n   geom_vline(xintercept = Mean, color = \"blue\", linetype = \"dashed\", size = 1) \n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nBit more advanced! (add another geom layer, in this case `geom_jitter`. What does it do? How is it different from `geom_point`?)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load ggplot2\nlibrary(ggplot2)\n\n# Sample data\nset.seed(123)\ndata <- data.frame(\n  Group = rep(c(\"A\", \"B\", \"C\"), each = 200),\n  Value = c(rnorm(200, mean = 5, sd = 1), \n            rnorm(200, mean = 6, sd = 1.2), \n            rnorm(200, mean = 7, sd = 1.5))\n)\n\n# Combined Plot\np1 <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +\n  # Violin + Boxplot + Jitter\n  geom_boxplot(width = 0.2, outlier.color = \"red\", outlier.size = 2, colour = \"black\") +\n  geom_jitter(position = position_jitter(0.2), color = \"black\", alpha = 0.4) + #scatter plot but in random positions, check geom_point() and see\n  labs(title = \"Boxplot and Violin Plot with Jitter\", x = \"Groups\", y = \"Values\") +\n  theme_minimal()\n\np2 <- ggplot(data, aes(x = Value, fill = Group)) +\n  # Histogram\n  geom_histogram(alpha = 0.6, position = \"identity\", binwidth = 0.3, colour = \"black\") +\n  labs(title = \"Histogram of Values by Group\", x = \"Values\", y = \"Count\") +\n  theme_minimal()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display both plots side by side\nlibrary(patchwork)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display both plots up down\nlibrary(patchwork)\np1 / p2\n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAlso, maybe we want to understand how the distribution varies by more groups. We can use facets:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gapminder)\n\n# Box plot with facets by year\nggplot(gapminder, aes(x = continent, y = lifeExp, fill = continent)) +\n  geom_boxplot() +\n  facet_wrap(~ year) +  # Create facets for each year\n  labs(title = \"Life Expectancy Across Continents by Year\",\n       x = \"Continent\",\n       y = \"Life Expectancy\") +\n  theme_minimal() + #just to make it nice\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels - just to make it nice\n```\n\n::: {.cell-output-display}\n![](HistogramBoxplot_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nWhat is happening here? View (gapminder) dataset. If we focus on 1952 year, extract the necessary values to create the boxplot for Africa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#for example \nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ lubridate 1.9.4     ✔ tibble    3.3.0\n✔ purrr     1.2.0     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nSubgroup <- gapminder %>% \n  filter(year == \"1952\") %>%\n  filter(continent == \"Africa\")\n#data wrangling - can learn more from Introduction exercise on data wrangling\n\nMedian <- median(Subgroup$lifeExp)\n\nMedian\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 38.833\n```\n\n\n:::\n:::\n\n\nDoes it match the plot? Continue with the rest of parameters (IQR, mean, quantile)\n",
    "supporting": [
      "HistogramBoxplot_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}