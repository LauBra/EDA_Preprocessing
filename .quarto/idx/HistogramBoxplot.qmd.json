{"title":"Histograms and Boxplots","markdown":{"headingText":"Histograms and Boxplots","containsRefs":false,"markdown":"\nHistograms show the overall shape and spread of the data distribution and box plots summarise key statistics (median, spread, and potential outliers) and are particularly helpful for comparing distributions across groups.\n\n### Summary Statistics\n\n```{r}\nlibrary(ggplot2)\n```\n\n```{r}\n# Example data\ndata <- data.frame(age = c(2,  45, 56, 47, 67, 67, 68, 72, 75, 80, 85,86, 89,125))\nhead(data)\n```\n\nWhat is the distribution of the age data? What are the mean, median and standard deviation?\n\n```{r}\nMean <- mean(data$age)\nMedian <- median(data$age)\nSd <- sd(data$age)\n```\n\nOther data distribution descriptors include quantiles, which divide data into equal-sized intervals:\n\n*0% (Minimum)* 25% (Q1, First Quartile) *50% (Median, Second Quartile)* 75% (Q3, Third Quartile) \\*100% (Maximum)\n\n```{r}\nQuantile <- quantile(data$age)\nQuantile\n```\n\nThe IQR (Interquartile Range) measures the spread of the middle 50% of your data.\n\nIf you look at the Quantile results above, you can calculate it from $IQR=Q3âˆ’Q1$, where Q3 is the value beyond which 75% of your data lies. What is then Q2? The value beyond which 25% of your data lies.\n\n```{r}\nIQR <- IQR(data$age)\nIQR\n```\n\nCan do it in a single go:\n\n```{r}\n\nsummary(data$age) \n```\n\nAs we saw, lots of different datasets can end up with these summary statistics, so lets plot it to get real insight about what is happening:\n\n## Histogram in R\n\nA histogram is a way to visualise the frequency distribution of a dataset. It groups data into bins and shows how many data points fall into each bin\n\n```{r}\nggplot(data, aes(x = age)) + \n  geom_histogram() \n```\n\nYou can modify the binwidth parameter, what is happening here?\n\n```{r}\nggplot(data, aes(x = age)) + \n  geom_histogram(binwidth = 30) \n```\n\nNow lets go back t original and add the mean and median\n\n```{r}\nggplot(data, aes(x = age)) + \n  geom_histogram() +\n  geom_vline(xintercept = Mean, color = \"red\", linetype = \"dashed\", size = 1) +\n  geom_vline(xintercept = Median, color = \"blue\", linetype = \"dashed\", size = 1)\n```\n\nIf do not remember how ggplot works , here is a cheatsheet: <https://rstudio.github.io/cheatsheets/html/data-visualization.html>\n\nIn summary, a histogram helps you understand the shape of your data distribution (e.g., normal, skewed) and peaks indicate the most frequent values.\n\n------------------------------------------------------------------------\n\n## Box Plot in R\n\nA box plot (or box-and-whisker plot) summarises the distribution of a dataset. It highlights:\n\n-   Median (middle line in the box).\n-   Quantiles (the box spans from the 25th percentile to the 75th percentile)\n-   IQR (Interquartile Range): The difference between the 75th and 25th percentiles - (IQR range calculated above)\n-   Whiskers: Extend to data points within 1.5\\*IQR (above or beyond = outliers)\n\n```{r}\nggplot(data, aes(x = age)) + \n  geom_boxplot() + \n  coord_flip() #have you checked what this does? Take it out and see\n```\n\nCan you see summary statistics mapped here?\n\nLets plot the mean (as it is a value that is not reflected in a boxplot!)\n\n```{r}\nggplot(data, aes(x = age)) + \n  geom_boxplot() + \n  coord_flip() + \n   geom_vline(xintercept = Mean, color = \"blue\", linetype = \"dashed\", size = 1) \n```\n\nBit more advanced! (add another geom layer, in this case `geom_jitter`. What does it do? How is it different from `geom_point`?)\n\n```{r}\n# Load ggplot2\nlibrary(ggplot2)\n\n# Sample data\nset.seed(123)\ndata <- data.frame(\n  Group = rep(c(\"A\", \"B\", \"C\"), each = 200),\n  Value = c(rnorm(200, mean = 5, sd = 1), \n            rnorm(200, mean = 6, sd = 1.2), \n            rnorm(200, mean = 7, sd = 1.5))\n)\n\n# Combined Plot\np1 <- ggplot(data, aes(x = Group, y = Value, fill = Group)) +\n  # Violin + Boxplot + Jitter\n  geom_boxplot(width = 0.2, outlier.color = \"red\", outlier.size = 2, colour = \"black\") +\n  geom_jitter(position = position_jitter(0.2), color = \"black\", alpha = 0.4) + #scatter plot but in random positions, check geom_point() and see\n  labs(title = \"Boxplot and Violin Plot with Jitter\", x = \"Groups\", y = \"Values\") +\n  theme_minimal()\n\np2 <- ggplot(data, aes(x = Value, fill = Group)) +\n  # Histogram\n  geom_histogram(alpha = 0.6, position = \"identity\", binwidth = 0.3, colour = \"black\") +\n  labs(title = \"Histogram of Values by Group\", x = \"Values\", y = \"Count\") +\n  theme_minimal()\n```\n\n```{r}\n# Display both plots side by side\nlibrary(patchwork)\np1 + p2\n\n```\n\n```{r}\n# Display both plots up down\nlibrary(patchwork)\np1 / p2\n\n```\n\nAlso, maybe we want to understand how the distribution varies by more groups. We can use facets:\n\n```{r}\n\nlibrary(gapminder)\n\n# Box plot with facets by year\nggplot(gapminder, aes(x = continent, y = lifeExp, fill = continent)) +\n  geom_boxplot() +\n  facet_wrap(~ year) +  # Create facets for each year\n  labs(title = \"Life Expectancy Across Continents by Year\",\n       x = \"Continent\",\n       y = \"Life Expectancy\") +\n  theme_minimal() + #just to make it nice\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels - just to make it nice\n\n```\n\nWhat is happening here? View (gapminder) dataset. If we focus on 1952 year, extract the necessary values to create the boxplot for Africa.\n\n```{r}\n#for example \nlibrary(tidyverse)\n\n\nSubgroup <- gapminder %>% \n  filter(year == \"1952\") %>%\n  filter(continent == \"Africa\")\n#data wrangling - can learn more from Introduction exercise on data wrangling\n\nMedian <- median(Subgroup$lifeExp)\n\nMedian\n```\n\nDoes it match the plot? Continue with the rest of parameters (IQR, mean, quantile)\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"python":{"version":"r-reticulate"},"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"HistogramBoxplot.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","editor":"visual","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}